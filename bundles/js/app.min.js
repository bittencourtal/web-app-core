!function(){angular.module("mdThemeColorsDSS",[]).factory("mdThemeColorsDSS",["mdThemeColors",function(e){return{init:function(){var n=[],t=Object.getOwnPropertyNames(e);dss.values=dss.values||[],dss.getKeys=function(){return dss.values.select(function(e){return e.key})},t.forEach(function(t,i){var o=Object.getOwnPropertyNames(e[t]);o.forEach(function(i){n.push({key:t+"."+i,value:e[t][i]})})}),n.forEach(function(e){dss.setProperty(e.key,e.value),dss.values.push(e)})}}}])}(),String.prototype.contains=function(e){return this.indexOf(e)>-1},String.prototype.replaceAll=function(e,n){if("."==e)return this.replace(/\./g,n);var t=new RegExp(e,"g");return this.replace(t,n)},String.prototype.startsWith||(String.prototype.startsWith=function(e,n){return n=n||0,this.substr(n,e.length)===e}),function(e){e.isAndroid=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("android")>-1},e.isIOS=function(){return/iPad|iPhone|iPod/.test(e.navigator.userAgent)&&!e.MSStream}}(window),function(e){var n=["squid-channel","squid-campaign","squid-login","squid-feed","squid-mission","squid-checkout","squid-user","squid-workflow"];e.squid.app=angular.module("squid-app",e.squid.defaultDependencies.concat(n)),e.squid.app.run(["$rootScope","auth","store","jwtHelper","$location","WorkflowInitializer",function(n,t,i,o,r,a){function c(){r.path(e.APP_CONFIG.LOGIN_ROUTE)}function s(){r.path(e.APP_CONFIG.START_VIEW)}function u(e){return e&&e.$$route&&e.$$route.requireLogin}function d(){var e=i.get("token");e&&(o.isTokenExpired(e)?$.jStorage.flush():t.authenticate(i.get("profile"),e))}function l(){t.signout(),i.remove("profile"),i.remove("token"),$.jStorage.flush(),e.APP_CONFIG.REQUIRE_AUTHENTICATION?c():s()}function f(){d(),t.isAuthenticated||($.jStorage.flush(),e.APP_CONFIG.REQUIRE_AUTHENTICATION&&c())}function p(n,i){a.initWorkflows(e.APP_CONFIG.WORKFLOWS.ROUTES.CHANGED)["catch"](l),u(i)&&!t.isAuthenticated&&c()}n=n||{},n.pageTitle="",n.setPageTitle=function(e){n.pageTitle=e},n.$on("$locationChangeStart",f),n.$on("$routeChangeSuccess",p),t.hookEvents()}])}(window),function(e){function n(e,n){function t(){Object.keys(e._PALETTES).forEach(function(n){var t=e._PALETTES[n],i=[];o[n]=i,Object.keys(t).forEach(function(e){/#[0-9A-Fa-f]{6}|0-9A-Fa-f]{8}\b/.exec(t[e])&&(i[e]=t[e])})})}function i(){n.factory("mdThemeColors",[function(){var n={},i=function(n){return function(){var i=e._THEMES["default"].colors[n],r=i.name;return o[r]||t(),o[r]["default"]=o[r][i.hues["default"]],o[r].hue1=o[r][i.hues["hue-1"]],o[r].hue2=o[r][i.hues["hue-2"]],o[r].hue3=o[r][i.hues["hue-3"]],o[r]}};return Object.defineProperty(n,"primary",{get:i("primary")}),Object.defineProperty(n,"accent",{get:i("accent")}),Object.defineProperty(n,"warn",{get:i("warn")}),Object.defineProperty(n,"background",{get:i("background")}),n}])}var o={};t(),i()}function t(n){e.APP_CONFIG.THEME.CUSTOM&&(n.definePalette(e.APP_CONFIG.THEME.PRIMARY_COLOR.name,e.APP_CONFIG.THEME.PRIMARY_COLOR.value),n._PALETTES[e.APP_CONFIG.THEME.PRIMARY_COLOR.name]=e.APP_CONFIG.THEME.PRIMARY_COLOR.value,n.definePalette(e.APP_CONFIG.THEME.SECONDARY_COLOR.name,e.APP_CONFIG.THEME.SECONDARY_COLOR.value),n._PALETTES[e.APP_CONFIG.THEME.SECONDARY_COLOR.name]=e.APP_CONFIG.THEME.SECONDARY_COLOR.value,n.definePalette(e.APP_CONFIG.THEME.WARN_COLOR.name,e.APP_CONFIG.THEME.WARN_COLOR.value),n._PALETTES[e.APP_CONFIG.THEME.WARN_COLOR.name]=e.APP_CONFIG.THEME.WARN_COLOR.value),n.theme("default").primaryPalette(e.APP_CONFIG.THEME.PRIMARY_COLOR.name).accentPalette(e.APP_CONFIG.THEME.SECONDARY_COLOR.name).warnPalette(e.APP_CONFIG.THEME.WARN_COLOR.name)}e.squid.app.config(["$httpProvider","authProvider","jwtInterceptorProvider","$mdThemingProvider","$mdIconProvider","$provide","$compileProvider","$sceProvider",function(i,o,r,a,c,s,u,d){i.defaults.useXDomain=!0,delete i.defaults.headers.common["X-Requested-With"],o.init({domain:e.APP_CONFIG.AUTH0.DOMAIN,clientID:e.APP_CONFIG.AUTH0.CLIENT_ID,loginUrl:e.APP_CONFIG.LOGIN_ROUTE}),r.tokenGetter=function(e){return e.get("token")},i.interceptors.push("jwtInterceptor"),i.interceptors.push("appIdInjector"),i.interceptors.push("corsHeaderFilterInjector"),u.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|chrome-extension|whatsapp):/),d.enabled(!1),t(a),n(a,s)}])}(window),function(e){"use strict";e.squid.app.controller("TemplateController",["$scope","$rootScope","auth","$location","$mdMedia","mdThemeColorsDSS",function(n,t,i,o,r,a){n=n||{},t.pageTitle="",t.secondaryNav=!1,t.isSmallDevice=r("sm"),n.isLoading=!1,n.viewUrl="",n.auth=i,n.$location=o,n.path=o.$$path.split("/")[1],n.toggleObject={item:-1},n.APP_DIR=e.APP_CONFIG.APP_DIR,n.scrollToUp=function(){$("html, body").animate({scrollTop:0},1500)},n.$on("$routeChangeStart",function(){NProgress.start()}),n.$on("$routeChangeError",function(){NProgress.done()}),n.$on("$routeChangeSuccess",function(e,i){t.pageTitle=i&&i.$$route?i.$$route.pageTitle:"",n.viewUrl=i&&i.$$route?i.$$route.viewUrl:"",t.secondaryNav=!(!i||!i.$$route)&&i.$$route.secondaryNav,n.path=o.$$path.split("/")[1],NProgress.done()}),a.init()}])}(window),function(e){"use strict";e.squid.app.factory("addressService",["$resource",function(e){return e("https://viacep.com.br/ws/:cep/json/",{cep:"@cep"})}])}(window),function(e){"use strict";e.squid.app.factory("navigationService",["$resource",function(e){return{isRefresh:function(){if(!window.performance)return!1;var e=window.performance.navigation;return e.type==e.TYPE_RELOAD}}}])}(window),function(e){"use strict";e.squid.app.directive("toolbar",["$rootScope","$mdSidenav","$location","auth","store","$mdMedia","AboutCampaignModalService","feedService","uniqueCampaignService",function(n,t,i,o,r,a,c,s,u){return{templateUrl:e.APP_CONFIG.APP_DIR+"/directives/toolbar/toolbar.html",restrict:"EA",replace:!0,scope:{},link:function(n,s,d,l){function f(){o.signout(),r.remove("profile"),r.remove("token"),$.jStorage.flush(),p()}function p(){i.path(e.APP_CONFIG.LOGIN_ROUTE)}function m(){i.path(e.APP_CONFIG.START_VIEW)}function g(){e.APP_CONFIG.CAMPAIGNS.UNIQUE_CAMPAIGN.IS_UNIQUE&&u.getUniqueCampaign().then(function(e){n.uniqueCampaign=e})}n.APP_CONFIG=e.APP_CONFIG,n.$mdSidenav=t,n.path=i.$$path.split("/")[1],n.auth=o,n.$location=i,n.uniqueCampaign=null,n.isSmallDevice=a("sm"),n.mobileSideMenuUrl=e.APP_CONFIG.APP_DIR+"/directives/toolbar/mobile-side-menu.html",n.getButtonClass=function(e){return{active:n.path==e}},n.goBack=function(){window.history.go(-1)},n.vincularConta=function(){try{var e={userId:o.profile.user_id,redirectUrl:window.location.href,email:o.profile.email},n=JSON.stringify(e),t=btoa(n);window.open("https://campanhas.squidit.com.br/v1/vincular-instagram?data="+t,"_blank")}catch(i){console.log(i)}},n.goToUniqueCampaign=function(){return n.uniqueCampaign?void u.redirectToUniqueCampaign(n.uniqueCampaign):u.notifyNotHaveCampaign()},n.goToUniqueCampaignRank=function(){return n.uniqueCampaign?void u.redirectToUniqueCampaignRank(n.uniqueCampaign):u.notifyNotHaveCampaign()},n.openAboutCampaign=function(){c.openDialog(o.profile).then(function(){},f)},n.logout=function(){o.signout(),r.remove("profile"),r.remove("token"),$.jStorage.flush(),e.APP_CONFIG.REQUIRE_AUTHENTICATION?p():m()},n.linkAccount=function(){n.isLoading=!0,u.getUniqueCampaign().then(function(e){var t=e._id;n.isLoading=!1,window.open(APP_CONFIG.CAMPAIGN_END_POINT_URL()+"/vincular/instagram?user_id="+o.profile.user_id+"&id="+t,"_blank")})},g()}}}])}(window),function(e){e.squid.app.factory("appIdInjector",[function(){return{request:function(n){return n.headers.app_id=e.APP_CONFIG.APP_ID(),n}}}])}(window),function(e){e.squid.app.factory("corsHeaderFilterInjector",[function(){function n(n){return n.startsWith(e.APP_CONFIG.END_POINT_URL())||n.startsWith(e.APP_CONFIG.CAMPAIGN_END_POINT_URL())||n.startsWith(e.APP_CONFIG.SPIDERMAN_END_POINT_URL())}return{request:function(e){return n(e.url)?e:(delete e.headers.app_id,delete e.headers.Authorization,e)}}}])}(window),function(e){"use strict";e.squid.app.factory("syncPromise",["$q",function(e){return function(n){return function(t){var i=e.defer();return i.resolve(n(t)),i.promise}}}])}(window),function(e){function n(n,t,i,o){function r(){o.get("token")&&n.path(e.APP_CONFIG.START_VIEW)}function a(){n.path(e.APP_CONFIG.LOGIN_ROUTE)}function c(){return s++,e.APP_CONFIG.REQUIRE_AUTHENTICATION?s>20?a():i.isAuthenticated?void r():t(c,500):r()}var s=0;c()}e.squid.app.controller("RedirectController",["$location","$timeout","auth","store",n]),e.squid.app.config(["$routeProvider",function(n){n.when("/redirect",{controller:"RedirectController",templateUrl:e.APP_CONFIG.VIEWS.TEMPLATES.DEFAULT()}).otherwise({redirectTo:"/redirect"})}])}(window),function(e){e.squid.campaign=angular.module("squid-campaign",[]),e.squid.campaign.controllers={}}(window),function(e){e.squid.channel=angular.module("squid-channel",[]),e.squid.channel.controllers={}}(window),function(e){e.squid.checkout=angular.module("squid-checkout",[]),e.squid.checkout.controllers={}}(window),function(e){e.squid.feed=angular.module("squid-feed",[])}(window),function(e){e.squid.login=angular.module("squid-login",[]),e.squid.login.controllers={}}(window),function(e){e.squid.mission=angular.module("squid-mission",[])}(window),function(e){e.squid.user=angular.module("squid-user",[]),e.squid.user.controllers={}}(window),function(e){e.squid.workflow=angular.module("squid-workflow",[]),e.squid.workflow.controllers={},e.squid.workflow.models={}}(window),function(e){"use strict";function n(n,t,i,o){n.TEXTS=e.APP_CONFIG.CAMPAIGNS.UNIQUE_CAMPAIGN.ABOUT.TEXTS,n.currentText=n.TEXTS.length>0?n.TEXTS.first():{},n.isFirstText=function(e){return n.TEXTS.first().ORDER==e.ORDER},n.isLastText=function(e){return n.TEXTS.last().ORDER==e.ORDER},n.isCurrentText=function(e){return n.currentText.ORDER==e.ORDER},n.back=function(){var e=n.TEXTS.first(function(e){return e.ORDER<n.currentText.ORDER});n.currentText=e?e:n.currentText},n.next=function(){var e=n.TEXTS.first(function(e){return e.ORDER>n.currentText.ORDER});n.currentText=e?e:n.currentText},n.ok=function(){o.storeAboutCampaignAnswer(!0),t.hide()}}e.squid.campaign.controllers.AboutCampaignDialogController=n,e.squid.campaign.controller("AboutCampaignDialogController",["$scope","$mdDialog","store","AboutCampaignModalService",n])}(window),function(e){"use strict";e.squid.campaign.controller("CampaignRankController",["$scope","campaignService","$routeParams","$mdMedia",function(e,n,t,i){function o(){return n.getRank().$promise.then(function(n){e.campaignRanking=n,a()})["catch"](function(e){console.log(e)})}function r(){e.isLoading=!0}function a(){e.isLoading=!1}function c(){r(),o()}e.isLoading=!1,e.campaignRanking=[],e.isSmallDevice=i("sm"),c()}])}(window),function(e){"use strict";function n(n,i,o,r,a,c,s,u,d,l,f){function p(){return i.isSmallDevice?"bottom left":"top right"}function m(){return a.get("profile")}function g(){var n=m();return n.user_metadata&&n.user_metadata.infos?n.user_metadata.infos.first(function(n){return n.channelId==e.APP_CONFIG.APP_ID()}):null}function h(e){var n=u.defer();return f.updateUserMetadata(e,n.resolve,n.reject),n.promise}function P(e){var n=g();return n||(n={}),n.acceptedTerms=e,h(n)}function v(){l.signout(),a.remove("profile"),a.remove("token"),$.jStorage.flush(),i.$broadcast("refreshLogin"),I()}function I(){r.path(e.APP_CONFIG.LOGIN_ROUTE)}function A(){var e=u.defer();P(!1).then(e.resolve,e.reject);var n=d.simple().content("Para participar da(s) campanha(s) você deve concordar com o regulamento.").action(t.close).parent($("main").get(0)).hideDelay(t.delay).highlightAction(!1).position(p());return v(),o(function(){d.show(n).then(function(e){})},800),e.promise}function C(){var e=u.defer();return P(!0).then(e.resolve,e.reject),e.promise}function w(){c.hide()}function O(){c.cancel()}function _(){w(),n.isLoading=!1}function T(){O(),n.isLoading=!1}n.isLoading=!1,n.TERMS_OF_USE=e.APP_CONFIG.TERMS_OF_USE,n.agree=function(){n.isLoading=!0,C().then(_)["catch"](T)},n.disagree=function(){n.isLoading=!0,A().then(_)["catch"](T)}}var t={delay:1e4,close:"OK"};e.squid.campaign.controllers.TermsOfUseDialogController=n,e.squid.campaign.controller("TermsOfUseDialogController",["$scope","$rootScope","$timeout","$location","store","$mdDialog","userService","$q","$mdToast","auth","squidSpidermanService",n])}(window),function(e){e.squid.campaign.config(["$routeProvider",function(n){n.when("/rank",{viewUrl:e.APP_CONFIG.APP_DIR+"/modules/campaign/views/campaign-rank.html",templateUrl:e.APP_CONFIG.VIEWS.TEMPLATES.DEFAULT(),pageTitle:"Ranking"})}])}(window),function(e){var n=e.squid.campaign.controllers;e.squid.login.factory("AboutCampaignModalService",["$q","store","$mdDialog",function(t,i,o){function r(){var i=t.defer();return o.show({controller:n.AboutCampaignDialogController,templateUrl:e.APP_CONFIG.APP_DIR+"/modules/campaign/views/about-campaign-dialog.html",parent:angular.element(document.body),clickOutsideToClose:!1,escapeToClose:!1}).then(i.resolve,i.reject),i.promise}function a(){var n=i.get("about-campaign-read");return!(!n||!n.read||n.channelId!=e.APP_CONFIG.APP_ID())&&n.read}function c(n){i.set("about-campaign-read",{channelId:e.APP_CONFIG.APP_ID(),read:n})}return{openDialog:r,aboutCampaignIsRead:a,storeAboutCampaignAnswer:c}}])}(window),function(e){"use strict";e.squid.app.factory("campaignService",["$resource",function(n){var t=e.APP_CONFIG.APP_ID(),i=e.APP_CONFIG.CAMPAIGN_END_POINT_URL();return n(i+"/channels/"+t+"/ranking",{channel:"@channel"},{getRank:{method:"GET",isArray:!0}})}])}(window),function(e,n){"use strict";e.squid.channel.factory("channelService",["$resource",function(e){var t=n.APP_ID();return e(n.CAMPAIGN_END_POINT_URL()+"/channels/"+t+"/:resource/:resourceId/:action/:actionId",{resource:"@resource",resourceId:"@resourceId",action:"@action",actionId:"@actionId"},{getActiveCampaigns:{method:"GET",params:{resource:"campaigns",action:"active"},isArray:!0},getCampaign:{method:"GET",params:{resource:"campaigns"}},getCampaignPrizes:{method:"GET",params:{resource:"campaigns",action:"prizes"},isArray:!0},getSelfPoints:{method:"GET",params:{resource:"self",action:"points"},isArray:!0},createCheckout:{method:"POST",url:n.CAMPAIGN_END_POINT_URL()+"/channels/"+t+"/campaigns/:resourceId/prizes/:action/checkout"},getPrize:{method:"GET",params:{resource:"campaigns",action:"prizes"}}})}])}(window,window.APP_CONFIG),function(e){"use strict";e.squid.checkout.controller("CheckoutController",["$scope",function(n){n.APP_CONFIG=e.APP_CONFIG}])}(window),function(e){"use strict";function n(e,n,t,i,o,r,a,c,s){function u(){return o.getSelfPoints({}).$promise.then(function(e){return e.filter(function(e){return e.campaign.id===r})[0]})}function d(n){e.checkoutResultMessage=n.message,e.checkoutDone=!0}function l(n){var t=n.data;e.checkoutResultMessage=t.message,e.checkoutDone=!1,p()}function f(){e.isLoading=!0}function p(){e.isLoading=!1}function m(n){e.userPointsAvailable=n.totalAvaible,e.isLoading=!1}function g(){e.checkoutResultMessage=""}function h(){e.isLoading=!0,u().then(m)}e.isLoading=!1,e.checkoutDone=!1,e.userPointsAvailable=0,e.checkoutSuccess=!1,e.prize=a,e.checkoutResultMessage="",e.doCheckout=function(){f(),c().then(s).then(d).then(p)["catch"](l)},e.cancel=function(){g(),t.cancel()},e.ok=function(){g(),t.hide(e.checkoutDone)},h()}e.squid.checkout.controller("CheckoutDialogController",["$scope","$q","$mdDialog","$mdToast","checkoutService","campaignId","prize","saveUserMetadataFn","checkoutPrizeFn",n]),e.squid.checkout.controllers.CheckoutDialogController=n}(window),function(e){"use strict";var n=e.squid.checkout.controllers;e.squid.checkout.controller("CheckoutPrizeController",["$scope","$rootScope","userService","channelService","$mdToast","$mdDialog","$routeParams","auth","$location",function(t,i,o,r,a,c,s,u,d){function l(){return r.getPrize({resourceId:h,actionId:P}).$promise}function f(){var e=t.prize.mission;return r.createCheckout({resourceId:e,action:P}).$promise}function p(){return c.show({controller:n.CheckoutDialogController,templateUrl:e.APP_CONFIG.APP_DIR+"/modules/checkout/views/checkout-dialog.html",parent:angular.element(document.body),clickOutsideToClose:!1,escapeToClose:!1,locals:{campaignId:h,saveUserMetadataFn:t.saveUserMetadata,checkoutPrizeFn:f,prize:t.prize}})}function m(e){e&&d.path("checkout")}function g(){t.isLoading=!0,l().then(function(e){t.prize=e,t.isLoading=!1})}t.auth=u,t.userMetadata={},t.isLoading=!1,t.prize={};var h=s.campaignId,P=s.prizeId;t.saveUserMetadata=function(){},t.rescue=function(){p().then(m)},g()}])}(window),function(e){e.squid.checkout.config(["$routeProvider",function(n){n.when("/checkout",{viewUrl:e.APP_CONFIG.APP_DIR+"/modules/checkout/views/checkout.html",templateUrl:e.APP_CONFIG.VIEWS.TEMPLATES.DEFAULT(),pageTitle:"Meus Pontos",requireLogin:!0}).when("/checkout/campaigns/:campaignId/prize/:prizeId",{viewUrl:e.APP_CONFIG.APP_DIR+"/modules/checkout/views/checkout-prize.html",templateUrl:e.APP_CONFIG.VIEWS.TEMPLATES.DEFAULT(),pageTitle:"Resgatar prêmio",secondaryNav:!0,requireLogin:!0})}])}(window),function(e){"use strict";e.squid.checkout.factory("checkoutService",["$resource",function(n){return n(e.APP_CONFIG.CAMPAIGN_END_POINT_URL()+"/checkouts/:resource/:resourceId",{resource:"@resource",resourceId:"@resourceId"},{getUserCheckouts:{method:"GET",params:{resource:"user",resourceId:"self"},isArray:!0}})}])}(window),function(e,n){"use strict";var t=[];e.squid.feed.controller("FeedController",["$scope","feedService","$element","$timeout","$q",function(e,i,o,r,a){function c(){function e(e){return t.any(function(n){return n.currentSrc==e.currentSrc})}function n(n){e(n)||n.play()}function i(e,n,t,i){return e<n&&t>i}function r(){var e=$(window).scrollTop()+c,t=$(window).scrollTop()+$(window).height()-c;a.each(function(o,r){var a=$(this).offset().top,c=$(this).height()+a,s=$(this).get(0);i(e,c,t,a)?n(s):s.pause()})}var a=$(o).find("video").not("[autoplay='autoplay']"),c=80;$(document).unbind("scroll"),$(document).on("scroll",r)}function s(){function e(e,n){var t=$(n).closest(".card");n.onplay=function(){t.addClass("video-playing")},n.onpause=function(){t.removeClass("video-playing")}}var n=$(o).find("video");$.each(n,e)}function u(){var e=a.defer();return r(function(){s(),c(),e.resolve()},100),e.promise}function d(n){var t=a.defer();return e.feedList=e.feedList.concat(n.data),e.paginationMetadata=n.paginationMetadata,t.resolve(),t.promise}function l(){e.isLoading=!1}function f(n){e.isLoading=!0,p(n).then(d).then(u).then(l)}function p(e){var t=a.defer(),o={};return n.ONLY_APPROVED&&(o.status="approved"),e&&(o.minId=e),i.getFeedParticipation(o,t.resolve,t.reject),t.promise}e.feedList=[],e.paginationMetadata={},e.isLoading=!1,e.getCardClass=function(e){var n={};return n["card-feed-"+e.mediaType]=!0,n},e.playVideo=function(e,n){var i=$(e.currentTarget).get(0);if(i)return i.paused?i.play():(t.push(i),t=t.distinct(function(e,n){return e.currentSrc==n.currentSrc}),i.pause())},e.loadMore=function(){!e.isLoading&&e.paginationMetadata.next&&f(e.paginationMetadata.next.minId)},f()}])}(window,window.APP_CONFIG.CAMPAIGNS),function(e){e.squid.feed.config(["$routeProvider",function(n){n.when("/feed",{viewUrl:e.APP_CONFIG.APP_DIR+"/modules/feed/views/feed.html",templateUrl:e.APP_CONFIG.VIEWS.TEMPLATES.DEFAULT(),pageTitle:"Feed"})}])}(window),function(e){"use strict";e.squid.feed.factory("feedService",["$resource",function(n){return n(e.APP_CONFIG.END_POINT_URL()+"/api/feed/:action/:id",{action:"@action",id:"@id"},{getFeedParticipation:{method:"GET",params:{action:"participation"}},getMissionsActive:{method:"GET",params:{action:"mission"}}})}])}(window),function(e){function n(){e.squid.login.config(["authProvider",function(e){e.on("loginSuccess",function(e,n,t,o){n.then(function(e){o.set("profile",e),o.set("token",t),i.trigger("loggedIn")})}),e.on("authenticated",function(e){t&&i.trigger("loggedIn")}),e.on("loginFailure",function(e,n){})}]),e.squid.login.run(["WorkflowInitializer",function(n){function o(){return n.initWorkflows(e.APP_CONFIG.WORKFLOWS.LOGIN.AFTER)}i.on("loggedIn",function(){t=!1,o()})}])}var t=(e.squid.campaign.controllers,e.squid.login.controllers,!0),i=angular.element(document);e.squid.login.controller("LoginController",["$scope","$rootScope","auth","$location","$timeout","store","$mdDialog","$mdToast","$q","userService","WorkflowInitializer",function(n,t,i,o,r,a,c,s,u,d,l){function f(){var e=u.defer();return i.isAuthenticated?(h().then(e.resolve,e.reject),e.promise):(e.resolve(),e.promise)}function p(){var e=u.defer();return n.isLoading=!1,e.resolve(),e.promise}function m(){var e=u.defer();return n.isLoading=!0,e.resolve(),e.promise}function g(){return l.initWorkflows(e.APP_CONFIG.WORKFLOWS.LOGIN.AFTER)}function h(){return m().then(g).then(p)}function P(){i.signin({connections:e.APP_CONFIG.AUTH0.CONNECTIONS,container:"login-box",icon:"../images/logo.png",dict:A},function(e,n){a.set("profile",e),a.set("token",n),h()},function(e){})}function v(){i.signin({connections:e.APP_CONFIG.AUTH0.CONNECTIONS,container:"login-box",icon:"../images/logo.png",dict:A})}function I(){n.isLoading=!1,i.config.auth0lib.$container=null,e.APP_CONFIG.USE_LOGIN_REDIRECT_MODE?v():P()}n.isLoading=!1;var A={loadingTitle:"carregando...",close:"fechar",signin:{title:"Seja bem-vindo!",signinText:"Entrar",signupText:"Cadastrar-se",usernamePlaceholder:"e-mail",emailPlaceholder:"e-mail",passwordPlaceholder:"Senha",separatorText:"ou",wrongEmailPasswordErrorText:"E-mail ou senha inválidos.",serverErrorText:"Você não está autorizado.",strategyEmailInvalid:"O e-mail é invalido.",strategyDomainInvalid:"O domínio {domain} não foi configurado.",returnUserLabel:"Da última vez você acessou como...",all:"Não é sua conta?",forgotText:"Esqueceu sua senha? Clique aqui."},signup:{serverErrorText:"Não foi possível se cadastrar."},reset:{serverErrorText:"Não foi possível resetar a senha."}};f().then(I),t.$on("refreshLogin",I)}]),e.APP_CONFIG.USE_LOGIN_REDIRECT_MODE&&n()}(window),function(e){e.squid.login.config(["$routeProvider",function(n){n.when("/login",{viewUrl:e.APP_CONFIG.APP_DIR+"/modules/login/views/index.html",templateUrl:e.APP_CONFIG.VIEWS.TEMPLATES.LOGIN,pageTitle:"Login",secondaryNav:!0})}])}(window),function(e){"use strict";e.squid.mission.controller("ActiveMissionController",["$scope","channelService","$mdToast","uniqueCampaignService",function(e,n,t,i){function o(){e.isLoading=!0,i.getUniqueCampaign().then(function(n){i.redirectToUniqueCampaign(n),e.isLoading=!1})["catch"](function(){i.notifyNotHaveCampaign(),e.isLoading=!1})}function r(){e.isLoading=!0,n.getActiveCampaigns({}).$promise.then(function(n){e.campaigns=n,e.isLoading=!1})["catch"](function(n){e.isLoading=!1})}function a(){APP_CONFIG.CAMPAIGNS.UNIQUE_CAMPAIGN.IS_UNIQUE?o():r()}e.campaigns=[],e.isLoading=!1,a()}])}(window),function(e){e.squid.mission.controller("ChallengeController",["$scope","mission","$mdDialog","shareService",function(n,t,i,o){function r(){n.mission.shareText=n.mission.shareText.replaceAll("#","%23")}function a(){o.shareMission({id:n.mission._id})}function c(){i.hide()}n.mission=t,n.isMobile=e.isIOS()||e.isAndroid(),n.urlToShare=window.location.href.replaceAll("/#",""),n.textToShare="",n.descriptionToShare="",n.share=function(){a(),c()},n.closeModal=function(){c()},r()}])}(window),function(e,n){"use strict";e.squid.mission.controller("MissionDetailsController",["$scope","$rootScope","$routeParams","participationService","$mdDialog","$timeout","channelService","$q",function(t,i,o,r,a,c,s,u){function d(e){return s.getCampaign({resourceId:e}).$promise}function l(e){var n=moment(),t=moment(e),i=moment(t,"DD/MM/YYYY HH:mm:ss").diff(moment(n,"DD/MM/YYYY HH:mm:ss")),o=moment.duration(i),r=Math.floor(o.asDays()),a=moment.utc(i).format("HH"),c=moment.utc(i).format("mm"),s=moment.utc(i).format("ss");return r<0?"Encerrada":r+" dias "+a+" horas "+c+" minutos e "+s+" segundos."}function f(){return t.participations.data.length>0&&!t.participations.minId||0==t.participations.data.length&&!S}function p(e){if(!t.isLoadingParticipations&&!f()){S=!1,t.isLoadingParticipations=!0;var i={id:e,minId:t.participations.minId,take:12};n.ONLY_APPROVED&&(i.status="approved"),r.getMissionParticipations(i,function(e){t.participations.data=t.participations.data.concat(e.data).distinct(function(e,n){return e._id==n._id}),t.participations.minId=e.paginationMetadata.next?e.paginationMetadata.next.minId:null,t.isLoadingParticipations=!1},function(){t.isLoadingParticipations=!1})}}function m(){setInterval(function(){t.campaign&&t.campaign.time&&(t.timeLeft=l(t.campaign.time.fixedEndDate),t.$apply())},1e3)}function g(n){a.show({controller:"ParticipateController",templateUrl:e.APP_CONFIG.APP_DIR+"/modules/mission/templates/participate.html",parent:angular.element(document.body),targetEvent:n,clickOutsideToClose:!0,locals:{mission:t.campaign}})}function h(n){a.show({controller:"ChallengeController",templateUrl:e.APP_CONFIG.APP_DIR+"/modules/mission/templates/challenge.html",parent:angular.element(document.body),targetEvent:n,clickOutsideToClose:!0,locals:{mission:t.campaign}})}function P(){t.isLoading=!0}function v(){t.isLoading=!1}function I(){t.menuIsOpen=!1}function A(e){return e?void c(function(){t.tooltipIsOpen=!0},250):void(t.tooltipIsOpen=!1)}function C(e){t.campaign=e}function w(e){return s.getCampaignPrizes({resourceId:e}).$promise}function O(e){t.campaignPrizes=e,t.allPrizesSoldOut=e.every(function(e){return!e.hasAvailableStock})}function _(){return P(),d(o.missionId).then(C).then(v)}function T(){w(o.missionId).then(O)}function E(){i.pageTitle="#"+t.campaign.hashtag}function N(){_().then(E),T(),p(o.missionId),m()}var S=!0;t.campaign={},t.campaignPrizes=[],t.participations={data:[],minId:""},t.isLoading=!1,t.isLoadingParticipations=!1,t.menuIsOpen=!1,t.timeLeft="--",t.tooltipIsOpen=!1,t.loadMoreParticipations=function(){p(o.missionId)},t.participate=function(e){I(),g(e)},t.challenge=function(e){I(),h(e)},t.toggleMenu=function(){e.isAndroid()&&(t.menuIsOpen=!t.menuIsOpen)},t.$watch("menuIsOpen",A),N()}])}(window,window.APP_CONFIG.CAMPAIGNS),function(e){e.squid.mission.controller("ParticipateController",["$scope","mission","$mdDialog",function(n,t,i){n.mission=t,n.isMobile=e.isIOS()||e.isAndroid(),n.openInstagram=function(){e.isIOS()?window.location="instagram://camera":window.location="intent://instagram.com/_n/mainfeed/#Intent;package=com.instagram.android;scheme=https;end",i.hide()},n.closeModal=function(){i.hide()}}])}(window),function(e){e.squid.mission.config(["$routeProvider",function(n){n.when("/mission/actives",{viewUrl:e.APP_CONFIG.APP_DIR+"/modules/mission/views/actives.html",templateUrl:e.APP_CONFIG.VIEWS.TEMPLATES.DEFAULT(),pageTitle:"Missões"}).when("/mission/mission-details/:missionId",{viewUrl:e.APP_CONFIG.APP_DIR+"/modules/mission/views/mission-details.html",templateUrl:e.APP_CONFIG.VIEWS.TEMPLATES.DEFAULT(),pageTitle:"",secondaryNav:!0})}])}(window),function(e){"use strict";e.squid.mission.factory("participationService",["$resource",function(n){return n(e.APP_CONFIG.END_POINT_URL()+"/api/participation/:action/:id",{action:"@action",id:"@id"},{getMissionParticipations:{method:"GET",params:{action:"mission"}},getUserParticipations:{method:"GET",params:{action:"user"}}})}])}(window),function(e){"use strict";e.squid.mission.factory("shareService",["$resource",function(n){return n(e.APP_CONFIG.END_POINT_URL()+"/api/share/:action/:id",{action:"@action",id:"@id"},{shareMission:{method:"POST",params:{action:"mission"}}})}])}(window),function(e){"use strict";var n={delay:1e4,close:"OK"};e.squid.mission.factory("uniqueCampaignService",["$rootScope","$mdToast","$q","$location","channelService",function(e,t,i,o,r){function a(){return e.isSmallDevice?"bottom left":"top right"}function c(){var e=t.simple().content("Não há campanha cadastrada no momento.").action(n.close).parent($("main").get(0)).hideDelay(n.delay).highlightAction(!1).position(a());t.show(e).then(function(e){})}function s(){var e=i.defer();return d?(e.resolve(d),e.promise):(r.getActiveCampaigns({},function(n){if(!n)return e.reject();var t=n.first();return t?(d=t,void e.resolve(t)):e.reject()},e.reject),e.promise)}function u(e){o.path("mission/mission-details/"+e._id)}var d=null;return{getUniqueCampaign:s,notifyNotHaveCampaign:c,redirectToUniqueCampaign:u}}])}(window),function(e){"use strict";var n={delay:1e4,close:"OK"};e.squid.user.controller("MyProfileController",["$scope","$rootScope","auth","userService","$location","participationService","$mdToast",function(e,t,i,o,r,a,c){function s(){return t.isSmallDevice?"bottom left":"top right"}function u(){return e.isLoadingParticipations||e.participations.data.length>0&&!e.participations.minId||0==e.participations.data.length&&!p}function d(e){var t=c.simple().content("Dados salvos :)").action(n.close).parent($("main").get(0)).hideDelay(n.delay).highlightAction(!1).position(s());c.show(t).then(function(e){})}function l(){u()||(p=!1,e.isLoadingParticipations=!0,a.getUserParticipations({id:i.profile.user_id,minId:e.participations.minId,take:12},function(n){e.participations.data=e.participations.data.concat(n.data).distinct(function(e,n){return e._id==n._id}),e.participations.minId=n.paginationMetadata.next?n.paginationMetadata.next.minId:null,e.isLoadingParticipations=!1},function(){e.isLoadingParticipations=!1}))}function f(){i.isAuthenticated&&l()}var p=!0;e.isSaving=!1,e.isLoadingParticipations=!1,e.auth=i,e.userMetadata={},e.selectedTabIndex=0,e.isLoading=!1,e.participations={data:[],minId:""},e.loadMoreParticipations=function(){i.isAuthenticated&&l()},e.save=function(){e.saveUserMetadata().then(d)},e.saveUserMetadata=function(){},e.getSaveButtonLabel=function(){return e.isSaving?"Salvando...":"Salvar"},f()}])}(window),function(e){function n(e,n,i,o,r,a){function c(){return n.isSmallDevice?"bottom left":"top right"}function s(e){return f.test(e)}function u(){e.isLoading=!1,i.hide()}function d(){e.isLoading=!1;var n=o.simple().content("Não foi possível salvar os dados, contate o administrador.").action(t.close).parent($("main").get(0)).hideDelay(t.delay).highlightAction(!1).position(c());o.show(n)}function l(){var e=o.simple().content("Insira um e-mail válido.").action(t.close).parent($("main").get(0)).hideDelay(t.delay).highlightAction(!1).position(c());o.show(e)}var f=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;e.isLoading=!1,e.userMetadata=a.getUserMetadata()||{},e.save=function(n){return s(n.email)?(e.isLoading=!0,void r.updateUserMetadata(n,u,d)):l()}}var t={delay:1e4,close:"OK"};e.squid.user.controllers.UserMetadataDialogController=n,e.squid.user.controller("UserMetadataDialogController",["$scope","$rootScope","$mdDialog","$mdToast","squidSpidermanService","userMetadataHelper",n])}(window),function(e){"use strict";e.squid.user.factory("userMetadataHelper",["store",function(n){function t(){return n.get("profile")}function i(){var e=o();return!!e&&e.acceptedTerms}function o(){var n=t();return n&&n.user_metadata&&n.user_metadata.infos?n.user_metadata.infos.first(function(n){return n.channelId==e.APP_CONFIG.APP_ID()}):null}return{getProfile:t,getUserMetadata:o,termsIsAccepted:i}}])}(window),function(e){e.squid.user.config(["$routeProvider",function(n){n.when("/my-profile",{viewUrl:e.APP_CONFIG.APP_DIR+"/modules/user/views/my-profile.html",templateUrl:e.APP_CONFIG.VIEWS.TEMPLATES.DEFAULT(),pageTitle:"Meu Perfil"})}])}(window),function(e){"use strict";e.squid.user.factory("squidSpidermanService",["$resource",function(n){return n(e.APP_CONFIG.SPIDERMAN_END_POINT_URL()+"/:action",{action:"@action"},{updateUserMetadata:{method:"PATCH",params:{action:"usermetadata"}},getUserMetadata:{method:"GET",params:{action:"usermetadata"}}})}])}(window),function(e){"use strict";e.squid.user.factory("userService",["$resource",function(n){return n(e.APP_CONFIG.END_POINT_URL()+"/api/user/:action/:id",{action:"@action",id:"@id"},{email:{method:"PUT",params:{action:"email"
}},update:{method:"PUT"}})}])}(window),function(e){"use strict";e.squid.user.factory("userStatisticsService",["$resource",function(n){return n(e.APP_CONFIG.END_POINT_URL()+"/api/statistics/user/:action/:id",{action:"@action",id:"@id"},{getUserProfileStatistics:{method:"GET",params:{action:"me"}}})}])}(window),function(e){function n(e,n,t,i){return{init:function(){var n=e.defer();return i.aboutCampaignIsRead()?(n.resolve(),n.promise):i.openDialog()}}}n.$inject=["$q","store","$mdDialog","AboutCampaignModalService"];var t=n.$inject.concat(n);e.squid.workflow.factory("AboutCampaignWorkflowInitializer",t)}(window),function(e){function n(n,t,i){function o(){return e.APP_CONFIG.WORKFLOWS.LOGIN.AFTER.any(function(e){return"RedirectToUniqueCampaignWorkflowInitializer"==e})}return{init:function(){var r=n.defer();return i.isRefresh()||o()?(r.resolve(),r.promise):(t.path(e.APP_CONFIG.START_VIEW),r.resolve(),r.promise)}}}n.$inject=["$q","$location","navigationService"];var t=n.$inject.concat(n);e.squid.workflow.factory("RedirectToStartViewWorkflowInitializer",t)}(window),function(e){function n(e,n,t,i,o){function r(){o.init(),i.notifyNotHaveCampaign()}return{init:function(){return i.getUniqueCampaign().then(i.redirectToUniqueCampaign)["catch"](r)}}}n.$inject=["$q","$location","navigationService","uniqueCampaignService","RedirectToStartViewWorkflowInitializer"];var t=n.$inject.concat(n);e.squid.workflow.factory("RedirectToUniqueCampaignWorkflowInitializer",t)}(window),function(e){function n(n,i,o){return{init:function(){var r=n.defer();return o.init().then(r.resolve)["catch"](function(){i.show({controller:t.TermsOfUseDialogController,templateUrl:e.APP_CONFIG.APP_DIR+"/modules/campaign/views/terms-of-use-dialog.html",parent:angular.element(document.body),clickOutsideToClose:!1,escapeToClose:!1}).then(r.resolve,r.reject)}),r.promise}}}var t=e.squid.campaign.controllers;n.$inject=["$q","$mdDialog","TermsOfUseValidator"],e.squid.workflow.factory("TermsOfUseWorkflowInitializer",n)}(window),function(e){function n(n,i,o,r){function a(){var n=r.getUserMetadata();return!!n&&e.APP_CONFIG.USER_METADATA.REQUIRED_INFOS.all(function(e){return!!n[e]})}return{init:function(){var i=n.defer();return a()?i.resolve():o.show({controller:t.UserMetadataDialogController,templateUrl:e.APP_CONFIG.APP_DIR+"/modules/user/views/user-metadata-dialog.html",parent:angular.element(document.body),clickOutsideToClose:!1,escapeToClose:!1}).then(i.resolve,i.reject),i.promise}}}var t=e.squid.user.controllers;n.$inject=["$q","store","$mdDialog","userMetadataHelper"];var i=n.$inject.concat(n);e.squid.workflow.factory("UserMetadataWorkflowInitializer",i)}(window),function(e){function n(e,n){this.initWorkflows=function(t){function i(){var e=arguments;async.eachSeries(e,function(e,n){e.init().then(function(e){n(null)})["catch"](n)},function(e){return e?o.reject(e):void o.resolve()})}var o=e.defer();return i.$inject=t,n.invoke(i),o.promise}}e.squid.workflow.factory("WorkflowInitializer",["$q","$injector",function(e,t){return new n(e,t)}])}(window),function(e){function n(e,n,t){return{init:function(){var n=e.defer();return t.termsIsAccepted()?n.resolve():n.reject(),n.promise}}}n.$inject=["$q","store","userMetadataHelper"];var t=n.$inject.concat(n);e.squid.workflow.factory("TermsOfUseValidator",t)}(window),function(e){"use strict";e.squid.checkout.directive("checkoutHistory",["checkoutService","auth",function(n,t){return{scope:{},templateUrl:e.APP_CONFIG.APP_DIR+"/modules/checkout/directives/checkout-history/checkout-history.html",link:function(e,i,o,r){function a(n){e.checkoutHistoryList=n}function c(){return n.getUserCheckouts().$promise}function s(){c().then(a)}e.isLoading=!1,e.auth=t,e.checkoutHistoryList=[],e.getStatusLabel=function(e){switch(e){case"requested":return"Solicitado";case"approved":return"Aprovado";case"reproved":return"Reprovado";default:return"?"}},s()}}}])}(window),function(e){"use strict";e.squid.checkout.controller("CheckoutRescueModalController",["$scope","$modalInstance","prize","auth","checkoutService","userService",function(e,n,t,i,o,r){function a(){e.email!=i.profile.email?r.email({email:e.email},function(e){c()},function(n){e.validateStatus=n.data.message}):c()}function c(){o.getPrize({id:t.id},function(n){e.validateStatus=n.message},function(n){e.validateStatus=n.data.message,n.data.message.contains("e-mail")&&(l=!0)})}function s(){o.validate({id:t.id},function(n){e.validateStatus=n.status,n.status.contains("ok")&&(d=!0)},function(n){e.validateStatus=n.data.message})}function u(){s()}e.prize=t,e.email=i.profile.email,e.validateStatus="carregando...";var d=!1,l=!1;e.rescue=function(){a()},e.cancel=function(){n.dismiss("cancel")},u()}])}(window),function(e){"use strict";e.squid.checkout.directive("checkoutRescue",["channelService","auth","$location",function(n,t,i){return{scope:{},templateUrl:e.APP_CONFIG.APP_DIR+"/modules/checkout/directives/checkout-rescue/checkout-rescue.html",link:function(e,o,r,a){function c(e){return!e.hasAvailableStock}function s(e){return function(n){return Object.assign({},e,{prizes:n,allPrizesSoldOut:n.every(c)})}}function u(e){return Promise.all(e.map(function(e){return n.getCampaignPrizes({resourceId:e.campaign.id}).$promise.then(s(e))}))}function d(n){e.checkoutList=n}function l(t){e.isLoading=!0,n.getSelfPoints().$promise.then(u).then(d).then(f)["catch"](f)}function f(){e.isLoading=!1}e.checkoutList=[],e.auth=t,e.isLoading=!1,e.hasPointsAvailable=function(e,n){return e.totalAvaible>=n.points},e.checkoutPrize=function(e){i.path("/checkout/campaigns/"+e.mission+"/prize/"+e._id)},l()}}}])}(window),function(e){"use strict";var n={delay:1e4,close:"OK"};e.squid.user.directive("userMetadataForm",["addressService","$q","$rootScope","$mdToast","syncPromise","squidSpidermanService",function(t,i,o,r,a,c){return{scope:{ngModel:"=",isSaving:"=",save:"="},templateUrl:e.APP_CONFIG.APP_DIR+"/modules/user/directives/user-metadata-form/user-metadata-form.html",link:function(s,u,d,l){function f(){return o.isSmallDevice?"bottom left":"top right"}function p(e){var n=i.defer();return e?(t.get({cep:e},n.resolve,n.reject),n.promise):(n.reject(),n.promise)}function m(e){return e.logradouro?e.logradouro+", "+e.complemento+", "+e.bairro:""}function g(e){s.ngModel.state=e.uf,s.ngModel.city=e.localidade,s.ngModel.address=m(e)}function h(){var e=i.defer();return c.getUserMetadata(e.resolve,e.reject),e.promise}function P(e){delete e.$promise,delete e.$resolved,e.birthday=moment(e.birthday)._d,s.ngModel=e}function v(e){var n=i.defer();return c.updateUserMetadata(e,n.resolve,n.reject),n.promise}function I(){s.isLoading=!0}function A(){s.isLoading=!1}function C(e){var t=r.simple().content(e).action(n.close).parent($("main").get(0)).hideDelay(n.delay).highlightAction(!1).position(f());r.show(t).then(function(e){})}function w(n){var t=e.APP_CONFIG.CHECKOUT.REQUIRED_INFOS.any(function(e){return!n[e]});return t&&C("Preencha os campos obrigatórios."),!t}function O(e){return s.isSaving=!1,e}function _(e){return function(n){s.isSaving=!1,e.reject(n)}}function T(){I(),h().then(a(P)).then(A)}s.isLoading=!1,s.states=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],s.save=function(){var e=i.defer();return w(s.ngModel)?(I(),s.isSaving=!0,v(s.ngModel).then(a(A)).then(a(O)).then(e.resolve)["catch"](_(e)),e.promise):(e.reject(),e.promise)},s.tryGetCep=function(e){e.length<8||p(e).then(a(g))},T()}}}])}(window);